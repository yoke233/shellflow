{
  "$schema": "https://raw.githubusercontent.com/shkm/shellflow/main/schemas/mappings.schema.json",
  // Shellflow Default Key Mappings
  // https://github.com/shkm/shellflow/blob/main/src/lib/defaultMappings.jsonc
  //
  // Key syntax: modifier-key (e.g., cmd-w, ctrl-shift-p)
  // Modifiers: cmd, ctrl, alt, shift
  // "cmd" = Cmd on macOS, Ctrl on other platforms
  //
  // Context expressions support: && (and), || (or), ! (not), () (grouping)
  // Example: "worktreeFocused && !drawerFocused"

  "bindings": [
    // ============================================================
    // Global bindings (no context = always active)
    // ============================================================
    {
      "bindings": {
        // App actions
        "cmd-o": "app::addProject",

        // Palette
        "cmd-shift-p": "palette::toggle",
        "cmd-shift-o": "palette::projectSwitcher"
      }
    },

    // ============================================================
    // Pickers open - escape to close
    // ============================================================
    {
      "context": "pickerOpen",
      "bindings": {
        "Escape": "palette::close"
      }
    },

    // ============================================================
    // Modal open - escape to close
    // ============================================================
    {
      "context": "modalOpen",
      "bindings": {
        "Escape": "modal::close"
      }
    },

    // ============================================================
    // Normal state (no picker or modal)
    // ============================================================
    {
      "context": "!pickerOpen && !modalOpen",
      "bindings": {
        // View controls
        "ctrl-`": "drawer::toggle",
        "cmd-b": "rightPanel::toggle",
        "cmd-shift-d": "diff::open",
        "shift-Escape": "drawer::expand",

        // Zoom
        "cmd-=": "view::zoomIn",
        "cmd--": "view::zoomOut",
        "cmd-shift-0": "view::zoomReset",

        // Focus
        "ctrl-;": "focus::switch",

        // Navigation history (go back/forward like browser)
        "cmd-[": "navigate::back",
        "cmd-]": "navigate::forward",

        // Navigation (sidebar)
        "cmd-ctrl-k": "navigate::prev",
        "cmd-ctrl-j": "navigate::next",
        "cmd-ctrl-0": "navigate::toProject",
        "cmd-ctrl-1": "navigate::toEntity1",
        "cmd-ctrl-2": "navigate::toEntity2",
        "cmd-ctrl-3": "navigate::toEntity3",
        "cmd-ctrl-4": "navigate::toEntity4",
        "cmd-ctrl-5": "navigate::toEntity5",
        "cmd-ctrl-6": "navigate::toEntity6",
        "cmd-ctrl-7": "navigate::toEntity7",
        "cmd-ctrl-8": "navigate::toEntity8",
        "cmd-ctrl-9": "navigate::toEntity9",

        // Tasks
        "cmd-;": "task::switcher",
        "cmd-r": "task::run",

        // Diff mode
        "cmd-shift-u": "diff::toggleMode"
      }
    },

    // ============================================================
    // Drawer open (select tabs by number, new tab)
    // ============================================================
    {
      "context": "drawerOpen && !pickerOpen && !modalOpen",
      "bindings": {
        "cmd-t": "drawer::newTab",
        "cmd-1": "drawer::selectTab1",
        "cmd-2": "drawer::selectTab2",
        "cmd-3": "drawer::selectTab3",
        "cmd-4": "drawer::selectTab4",
        "cmd-5": "drawer::selectTab5",
        "cmd-6": "drawer::selectTab6",
        "cmd-7": "drawer::selectTab7",
        "cmd-8": "drawer::selectTab8",
        "cmd-9": "drawer::selectTab9"
      }
    },

    // ============================================================
    // Drawer focused
    // ============================================================
    {
      "context": "drawerFocused",
      "bindings": {
        "cmd-w": "drawer::closeTab",
        "cmd-ctrl-h": "drawer::prevTab",
        "cmd-ctrl-l": "drawer::nextTab",
        "ctrl-Tab": "drawer::nextTab",
        "ctrl-shift-Tab": "drawer::prevTab"
      }
    },

    // ============================================================
    // Main pane focused - session tabs (applies to all session types)
    // ============================================================
    {
      "context": "mainFocused && !pickerOpen && !modalOpen",
      "bindings": {
        "cmd-t": "session::newTab",
        "cmd-w": "session::closeTab",
        "cmd-shift-w": "session::closeSession",
        "cmd-ctrl-h": "session::prevTab",
        "cmd-ctrl-l": "session::nextTab",
        "cmd-1": "session::selectTab1",
        "cmd-2": "session::selectTab2",
        "cmd-3": "session::selectTab3",
        "cmd-4": "session::selectTab4",
        "cmd-5": "session::selectTab5",
        "cmd-6": "session::selectTab6",
        "cmd-7": "session::selectTab7",
        "cmd-8": "session::selectTab8",
        "cmd-9": "session::selectTab9"
      }
    },

    // ============================================================
    // Scratch terminal (not drawer focused) - new scratch and other actions
    // ============================================================
    {
      "context": "scratchFocused && !drawerFocused",
      "bindings": {
        "cmd-n": "scratch::new",
        "cmd-shift-n": "scratch::new",
        "F2": "scratch::renameSession"
      }
    },

    // ============================================================
    // Worktree (not drawer focused) - worktree-specific actions
    // ============================================================
    {
      "context": "worktreeFocused && !drawerFocused",
      "bindings": {
        "cmd-n": "worktree::new",
        "cmd-shift-n": "scratch::new",
        "F2": "worktree::renameBranch"
      }
    },

    // ============================================================
    // Project (no worktree selected, not drawer focused)
    // ============================================================
    {
      "context": "projectFocused && !drawerFocused",
      "bindings": {
        "cmd-n": "worktree::new",
        "cmd-shift-n": "scratch::new"
      }
    },

    // ============================================================
    // Diff view navigation (when viewing a diff)
    // ============================================================
    {
      "context": "diffViewOpen && !pickerOpen && !modalOpen",
      "bindings": {
        "cmd-j": "diff::nextFile",
        "cmd-k": "diff::prevFile"
      }
    },

    // ============================================================
    // Terminal copy/paste (when in any terminal context)
    // These work in both main and drawer terminals
    // ============================================================
    {
      "context": "mainFocused",
      "bindings": {
        "cmd-c": "terminal::copy",
        "cmd-v": "terminal::paste"
      }
    },
    {
      "context": "drawerFocused",
      "bindings": {
        "cmd-c": "terminal::copy",
        "cmd-v": "terminal::paste"
      }
    },

    // ============================================================
    // Split actions (vim-style splits)
    // ============================================================
    {
      "context": "!pickerOpen && !modalOpen",
      "bindings": {
        "ctrl-shift-\\": "split::horizontal",
        "ctrl-shift--": "split::vertical",
        "ctrl-shift-h": "split::focusLeft",
        "ctrl-shift-j": "split::focusDown",
        "ctrl-shift-k": "split::focusUp",
        "ctrl-shift-l": "split::focusRight"
      }
    }
  ]
}
